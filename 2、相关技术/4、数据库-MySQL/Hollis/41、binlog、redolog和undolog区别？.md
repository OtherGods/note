#binlog #redolog #undolog

# 典型回答

在MySQL数据库中，binlog、redolog和undolog都是日志类型文件，但它们各自的作用和实现方式有所不同。
1. <font color="red" size=5>binlog主要用来对数据库进行数据备份、崩溃恢复和数据复制等操作</font>
2. <font color="red" size=5>redo log和undo log主要用于事务管理，记录的是数据修改操作和回滚操作</font>
	- <font color="blue" size=5>redolog用来做恢复(数据库服务器宕机重启等)</font>
		- [11、InnoDB的一次更新事务过程是怎么样的？](2、相关技术/4、数据库-MySQL/Hollis/11、InnoDB的一次更新事务过程是怎么样的？.md)
		- [71、什么是事务的2阶段提交？](2、相关技术/4、数据库-MySQL/Hollis/71、什么是事务的2阶段提交？.md)
		- [129、MySQL能保证数据百分百不丢吗？](2、相关技术/4、数据库-MySQL/Hollis/129、MySQL能保证数据百分百不丢吗？.md)
	- <font color="blue" size=5>undolog用来做回滚（SQL执行异常）</font>

> **崩溃恢复**是指在数据库系统因为某种原因而发生崩溃或非正常关闭后，通过一系列机制和步骤来恢复数据库到一个一致性和可用的状态。
> **崩溃恢复**是数据库管理系统的重要功能，它确保数据库在出现异常情况后能够自动恢复，避免数据丢失或数据库状态不一致的问题。

在MySQL中，<font size=5 color="red">redo log和undo log只适用于InnoDB存储引擎，因为<font color="blue">要支持事务</font></font>。而不适用于MyISAM等其他存储引擎。而**binlog则适用于所有存储引擎**。

1. binlog是MySQL用于记录数据库中的**所有DDL语句和DML语句**的一种<font color="red"size=5>二进制日志</font>。它记录了所有对数据库结构和数据的修改操作，如INSERT、UPDATE和DELETE等。**binlog主要用来对数据库进行数据备份、灾难恢复和数据复制等操作**。binlog的格式分为基于语句的格式和基于行的格式。
2. **Redo Log是MySQL用于实现崩溃恢复和数据持久性的一种机制**。在事务进行过程中，MySQL会将事务做了什么改动到Redo Log中。当系统崩溃或者发生异常情况时，MySQL会利用Redo Log中的记录信息来进行恢复操作，将事务所做的修改持久化到磁盘中。
3. **Undo Log则用于在事务回滚或系统崩溃时撤销（回滚）事务所做的修改**。当一个事务执行过程中，MySQL会将事务修改前的数据记录到Undo Log中。如果事务需要回滚，则会从Undo Log中找到相应的记录来撤销事务所做的修改。另外，*Undo Log还支持MVCC（多版本并发控制）机制，用于在并发事务执行时提供一定的隔离性*。

|         | 支持引擎            | 主要作用                     | ACID        | 主从          |
| ------- | --------------- | ------------------------ | ----------- | ----------- |
| binlog  | innodb、myisam…… | 数据备份、崩溃恢复和主从复制           | -           | 保证主从服务器的一致性 |
| redolog | innodb（支持事务）    | 崩溃恢复/数据持久化（事务的修改会持久化到磁盘） | 持久性         | -           |
| undolog | innodb（支持事务）    | 事务回滚、MVCC                | 一致性、原子性、隔离性 | -           |

很多人不知道该怎么记忆，参考咱们的读者@彭超 的建议，可以这么记忆：
1. undo就是回退的意思，就跟在文本编辑器里面有一个undo按钮一样，你编辑的东西，按一下这个undo按钮就回退到上一个版本了。
2. redo是“re”+"do"，"re"就是重来一次的意思，“do”就是做的意思。所以连在一起，就是重新再做一遍，也就是重新再执行一次sql。那么什么时候需要重新再执行一次sql呢？执行的数据丢了嘛，自然就需要重新执行一次。
3. bin就是“binary”的缩写，"binary"就是二进制的意思，可以引申为“原始”的意思，所以bin log就是最全最原始的东西，里面包含了一切，所以可以用来做备份，有了它，就有了一切。

# 扩展知识

## undolog 和 redolog区别

- 目的：**Redo log的目的是为了保证事务的持久性**，主要用于崩溃恢复，而**Undo log的目的是为了保证事务的原子性和一致性**，主要用于事务回滚。
- 记录内容：
	- Redo Log 记录了**事务的所有数据更改**（这些日志不仅仅记录了数据更改的最终结果，而且还记录了实现这些更改的具体操作）
	- Undo log记录的是**事务执行前的内容**。