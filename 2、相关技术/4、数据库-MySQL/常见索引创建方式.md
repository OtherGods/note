# ChatGPT

在 MySQL 8 中，创建常见索引的方式主要包括以下几种。这里按索引类型分类，并配合语法、示例、使用场景做了总结，方便你参考和实战使用。

## 一、主键索引（PRIMARY KEY）

### 作用：

唯一标识一行记录，不允许 NULL，一张表只能有一个。

### 创建方式：

**方式 1：创建表时定义主键**
```sql
CREATE TABLE user (
  id INT PRIMARY KEY,
  name VARCHAR(100)
);
```

**方式 2：通过 `ALTER` 添加主键**
```sql
ALTER TABLE user ADD PRIMARY KEY (id);
```

## 二、唯一索引（UNIQUE INDEX / UNIQUE KEY）

### 作用：

保证列值唯一，允许 NULL（多个 NULL 视为不同值）。

### 创建方式：

**方式 1：建表时指定**
```sql
CREATE TABLE user (
  email VARCHAR(255) UNIQUE
);
```

**方式 2：建表时使用 `UNIQUE KEY` 明确命名**
```sql
CREATE TABLE user (
  email VARCHAR(255),
  UNIQUE KEY uk_email (email)
);
```

**方式 3：`ALTER` 添加唯一索引**
```sql
ALTER TABLE user ADD UNIQUE INDEX uk_email (email);
```

## 三、普通索引（INDEX / KEY）

### 作用：

加速查询，无唯一性约束，可建多个。

### 创建方式：

**建表时指定**
```sql
CREATE TABLE product (
  id INT PRIMARY KEY,
  category_id INT,
  KEY idx_category (category_id)
);
```

**使用 `ALTER` 添加普通索引**
```sql
ALTER TABLE product ADD INDEX idx_category (category_id);
```


## 四、联合索引（Composite Index）

### 作用：

多个列组成一个索引，用于多条件联合查询。

### 创建方式：

```sql
CREATE INDEX idx_name_age ON user (name, age);
-- 或
ALTER TABLE user ADD INDEX idx_name_age (name, age);
```

> 🔸 注意：联合索引是“最左前缀匹配原则”生效的，比如 `(name, age)` 可支持 `(name)` 和 `(name, age)`，但不支持只用 `(age)`。


## 五、前缀索引（Prefix Index）

### 作用：

对长文本字段（如 VARCHAR 或 TEXT）只索引前面一部分，节省空间。

### 创建方式：

```sql
CREATE TABLE log (
  log_id INT,
  message TEXT,
  INDEX idx_msg (message(100))  -- 只索引前100字符
);
```

> 🔸 只能用于 CHAR/VARCHAR/BLOB/TEXT 等类型，且需指定前缀长度。

## 六、全文索引（FULLTEXT）

### 作用：

用于全文搜索，支持自然语言查询（如 `MATCH ... AGAINST`）

### 创建方式（MySQL 5.6+ 支持 InnoDB 的全文索引）：

```sql
CREATE TABLE article (
  id INT PRIMARY KEY,
  content TEXT,
  FULLTEXT INDEX idx_content (content)
);
```


## 七、空间索引（SPATIAL）

### 作用：

用于地理空间数据（如 POINT、GEOMETRY 等）

### 示例：

```sql
CREATE TABLE locations (
  id INT PRIMARY KEY,
  location POINT,
  SPATIAL INDEX idx_location (location)
);
```

> 🔸 仅支持 `MyISAM` 或 InnoDB（MySQL 5.7+）+ SRID。


## 八、隐式索引（自动创建）

MySQL 自动为以下情况创建索引：

|情况|说明|
|---|---|
|`PRIMARY KEY`|自动创建主键索引|
|`UNIQUE`|自动创建唯一索引|
|外键（`FOREIGN KEY`）|自动为外键列创建索引|
|`AUTO_INCREMENT` 字段|必须是索引的一部分|

## 九、索引命名规范（建议）

- `idx_字段名` → 普通索引
- `uk_字段名` → 唯一索引
- `pk_字段名` → 主键索引
- `fk_字段名` → 外键索引
- `ft_字段名` → 全文索引

## 十、补充：显示已有索引

```sql
SHOW INDEX FROM your_table;
```

查看已有索引类型、列、唯一性等。

## 总结一览表

| 索引类型 | 关键词                 | 是否唯一 | 是否允许 NULL | 适用字段类型                | SQL                                                                                                            |
| ---- | ------------------- | ---- | --------- | --------------------- | -------------------------------------------------------------------------------------------------------------- |
| 主键索引 | PRIMARY KEY         | ✅ 是  | ❌ 否       | 任意                    | ALTER TABLE user ADD PRIMARY KEY (id);                                                                         |
| 唯一索引 | UNIQUE / UNIQUE KEY | ✅ 是  | ✅ 允许      | 任意                    | ALTER TABLE user ADD UNIQUE INDEX uk_email (email);                                                            |
| 普通索引 | INDEX / KEY         | ❌ 否  | ✅ 允许      | 任意                    | ALTER TABLE product ADD INDEX idx_category (category_id);                                                      |
| 联合索引 | 多列索引组合              | 看定义  | 看定义       | 任意                    | CREATE INDEX idx_name_age ON user (name, age);<br>-- 或<br>ALTER TABLE user ADD INDEX idx_name_age (name, age); |
| 前缀索引 | 列名(长度)              | 看定义  | 看定义       | VARCHAR / TEXT 等      | -                                                                                                              |
| 全文索引 | FULLTEXT            | ❌ 否  | ✅ 允许      | TEXT / CHAR / VARCHAR | -                                                                                                              |
| 空间索引 | SPATIAL             | ❌ 否  | ❌ 否       | GEOMETRY 类型           | -                                                                                                              |

如果你想了解 **每种索引的性能特征、使用场景、建错后如何定位和修复**，我可以继续带你分析实战案例。是否需要？
