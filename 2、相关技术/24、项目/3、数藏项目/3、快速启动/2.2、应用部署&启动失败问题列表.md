### 0、项目编译错误

给大家的代码都是可以编译通过的，如果有编译问题，请检查下自己的jdk及maven版本。

如果是yml文件中的爆红，可以忽略，没影响。
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042344041.png)

### 1、开启 mock 之后，启动报错如下：

```
Caused by: java.lang.IllegalArgumentException: Could not resolve placeholder 'nft.turbo.chain.type' in value "${nft.turbo.chain.type}"

Field osservice in cn.hollis.nft.turbo.user.controler.UserControler required a bean of type 'cn.hollis.nft.turbo.file.Ossservice that could not be found
```

以上类似的错误，都是因为没有正确的增加配置文件导致的，需要把下面的配置给他配置上，要么配置到 nacos 中，要么在你本地的 application.yml 中配置一下。
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042345288.png)

### 2、RpcException: Invoke remote method timeout.

```
2024-06-16T17:05:11.654+08:00 ERROR 25397 --- [nfturbo-business] [ncesChangeEvent] o.a.d.r.client.metadata.MetadataUtils    :  [DUBBO] Failed to get app metadata for revision b06215b2a18242572cf8c44e5797efc5 for type local from instance 198.18.0.1:20881, dubbo version: 3.2.10, current host: 198.11.0.1, error code: 1-39. This may be caused by , go to https://dubbo.apache.org/faq/1/39 to find instructions. 
org.apache.dubbo.rpc.RpcException: Invoke remote method timeout. method: getMetadataInfo, provider: dubbo://198.11.0.1:20881/org.apache.dubbo.metadata.MetadataService?connections=1&corethreads=2&dubbo=2.0.2&group=nfturbo-business&ipv6=fc00:1234:ffff:0:0:0:0:10&port=20881&prefer.serialization=fastjson2,hessian2&protocol=dubbo&release=3.2.10&retries=0&side=consumer&threadpool=cached&threads=100&timeout=5000&version=1.0.0, cause: Timeout after 5000ms waiting for result. at org.apache.dubbo.rpc.protocol.AbstractInvoker.waitForResultIfSync(AbstractInvoker.java:330)
```

出现这个错误，可能是你的 dubbo 的命名空间配置的不对，需要确保：
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042346022.png)

这玩意在 nacos 上也有，需要你手动去创建一个 namesapce：
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042346841.png)

### 3、应用启动后就卡住了，没有内容了，自己就停了

这种是因为日志没有输出到控制台，需要去找到日志文件看里面的报错，默认情况下日志在~/nfturbo-business/logs 下面，如果找不到，可以自己改下 logback 配置
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042347767.png)

把地址写死，然后去你写死的地址中找日志。

### 4、下载nacos docker镜像 提示 docker.io timeout

这里记得9848端口也要开放解决方案就是找一些能用的镜像源，可以参考这个：https://gist.github.com/y0ngb1n/7e8f16af3242c7815e7ca2f0833d3ea6

### 5、编译器报错提示：请使用 -source 21 或更高版本

![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042350109.png)

因为代码中用了 JDK 21的语法特性，需要去修改编译版本升级到21，下图中的几个地方都需要改：

![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042350072.png)

这里的 Language level也要改，要不能小于21

![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042350971.png)

![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042351058.png)

### 6、开启 es 之后，提示CollectionEsMapper找不到

Field collectionEsMapper in cn.hollis.nft.turbo.collection.domain.service.impl.es.CollectionEsService required a bean of type 'cn.hollis.nft.turbo.collection.infrastructure.es.mapper.CollectionEsMapper' that could not be found.
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042351173.png)

发生这个问题，是因为CollectionEsMapper其实是基于 easy-es 实现的，而 easy-es如果没有开启的话，是无法找到的，所以，需要把他也开启，配置在 es.yml 中：
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042351370.png)

把 easy-es.enable 设置为true。

### 7、smsService 找不到

![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042352903.png)

-Dspring.profiles.active=dev 和 spring.sms.enabled=true 至少要配置一个。要不然会找不到这个 bean。

### 8、应用启动报错-service.vgroupMapping.default_tx_group configuration item is required

![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042352783.png)

报这个错，说明你的 seata 没有正确部署，如果你按照步骤正确的部署了 seata 肯定不会报这个错，解决方案有两个。
[9、Seata部署](2、相关技术/24、项目/3、数藏项目/2、中间件部署/9、Seata部署.md)

第一个，就是参考上面的文档，去正确部署 seata，然后你就会在你的 nacos 上有一份seataServer.properties的配置文件，其中就有`service.vgroupMapping.default_tx_group=default` 这行内容，就可以让应用启动成功了。

另外一个方案，就是单独加一份配置。 在你的 seata 的 namespace 中，定义一个配置，名字为：service.vgroupMapping.default_tx_group

![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042353674.png)

值为：default
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/202411042353093.png)

如果改完还是不行，再确认下 seata.yml 中的 namespace 是否已经修改，需要和你nacos 上创建的命名空间保持一致。

### 9、启动成功后，nacos上注册的ip地址不正确

正常情况下，启动成功后，在nacos上会注册列表会显示你的ip地址，但是因为有些原因，比如你的本地机器上网卡问题、安装了docker等问题， 会导致你注册上去的ip不对，比如有兄弟注册上去的ip是2.0.0.1，这显然有问题。

解决方式就是可以通过Java命令行参数参数指定向nacos暴漏的地址：

`-DDUBBO_IP_TO_REGISTRY=139.11.11.11`

`-Dspring.cloud.nacos.discovery.ip=139.11.11.11`

把里面的139.11.11.11 改成你自己的ip就行了。

`-DDUBBO_IP_TO_REGISTRY`用于指定注册dubbo的暴露的ip地址

`-Dspring.cloud.nacos.discovery.ip`用于指定注册到loadbalancer暴露的ip地址

使用示例：
```shell
java -DDUBBO_IP_TO_REGISTRY=139.11.11.11 -jar demo-provider.jar
java -Dspring.cloud.nacos.discovery.ip=139.11.11.11 -jar Application.jar
```

这两个命令主要在于它们设置的参数和使用的框架不同，具体区别如下：

#### 9.1、DUBBO 

`java -DDUBBO_IP_TO_REGISTRY=139.11.11.11 -jar demo-provider.jar`

- **参数：** `-DDUBBO_IP_TO_REGISTRY=139.11.11.11`
- **框架：** Dubbo
- **作用：**
  - 该命令用于启动一个 Dubbo 应用程序（如 `demo-provider.jar`），并指定服务注册到注册中心时的 IP 地址为 `139.11.11.11`。
  - `DUBBO_IP_TO_REGISTRY` 是 Dubbo 的一个系统属性，它决定了服务提供者在向注册中心（如 Zookeeper 或 Nacos）注册时使用的 IP 地址。
  - 这对在有多个网络接口或 IP 的机器上运行的应用程序特别有用，可以确保消费者能够通过正确的 IP 地址访问到提供的服务。

#### 9.2、SpringCloudNcos

`java -Dspring.cloud.nacos.discovery.ip=139.11.11.11 -jar Application.jar`

- **参数：** `-Dspring.cloud.nacos.discovery.ip=139.11.11.11`
- **框架：** Spring Cloud
- **作用：**
  - 该命令用于启动一个 Spring Cloud 应用程序（如 `Application.jar`），并指定服务注册到 Nacos 注册中心时的 IP 地址为 `139.11.11.11`。
  - `spring.cloud.nacos.discovery.ip` 是 Spring Cloud Nacos 的一个配置属性，它用于设置服务在向 Nacos 注册中心注册时的 IP 地址。
  - 这在容器化环境或有多个网络接口的机器上运行的应用程序中尤为重要，可以确保其他服务通过正确的 IP 地址访问到这个服务。

#### 9.3、总结

- **框架不同：** 第一个命令用于 Dubbo 框架，第二个命令用于 Spring Cloud 框架。
- **配置属性不同：** 
  - `-DDUBBO_IP_TO_REGISTRY` 是 Dubbo 的配置属性，用于指定 Dubbo 服务注册的 IP 地址。
  - `-Dspring.cloud.nacos.discovery.ip` 是 Spring Cloud Nacos 的配置属性，用于指定 Spring Cloud 服务注册到 Nacos 时的 IP 地址。
- **目的相同：** 两个命令的目的是相同的，都是为了确保服务在向注册中心注册时使用指定的 IP 地址，从而确保其他服务能够通过正确的 IP 地址访问到该服务。

这些配置在有多个网络接口或 IP 的环境中特别有用，确保服务消费者能够找到并正确访问服务提供者。

