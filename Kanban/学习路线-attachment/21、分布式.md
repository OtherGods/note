视频：

1. [**《MIT 6.824 Distributed Systems Spring 2020 分布式系统 中文翻译版合集》**](https://link.zhihu.com/?target=https%3A//www.bilibili.com/video/av91748150)
   

书籍：

1. [从零开始学架构](https://book.douban.com/subject/30335935/)
   
2. [软件架构设计](https://book.douban.com/subject/30443578/)
   

JavaGuide：

1. [Java学习&面试指南](https://javaguide.cn/home.html)
   
2. [《Java面试指北》](https://www.yuque.com/snailclimb/mf2z3k)
   
3. 知乎分享如下：
   

### CAP 理论

CAP 也就是 Consistency（一致性）、Availability（可用性）、Partition Tolerance（分区容错性） 这三个单词首字母组合。

关于 CAP 的详细解读请看：[《CAP 理论解读》](https://link.zhihu.com/?target=https%3A//javaguide.cn/distributed-system/theorem%26algorithm%26protocol/cap%26base-theorem.html)。

### BASE 理论

**BASE** 是 **Basically Available（基本可用）** 、**Soft-state（软状态）** 和 **Eventually Consistent（最终一致性）** 三个短语的缩写。BASE 理论是对 CAP 中一致性和可用性权衡的结果，其来源于对大规模互联网系统分布式实践的总结，是基于 CAP 定理逐步演化而来的，它大大降低了我们对系统的要求。

关于 CAP 的详细解读请看：[《BASE 理论解读》](https://link.zhihu.com/?target=https%3A//javaguide.cn/distributed-system/theorem%26algorithm%26protocol/cap%26base-theorem.html)。

### Paxos 算法和 Raft 算法

**Paxos 算法**诞生于 1990 年，这是一种解决分布式系统一致性的经典算法 。但是，由于 Paxos 算法非常难以理解和实现，不断有人尝试简化这一算法。到了 2013 年才诞生了一个比 Paxos 算法更易理解和实现的分布式一致性算法—**Raft 算法**。

### RPC

RPC 让调用远程服务调用像调用本地方法那样简单。

Dubbo 是一款国产的 RPC 框架，由阿里开源。

### 服务注册与发现

Eureka、Zookeeper、Consul、Nacos 都可以提供服务注册与发现的功能。
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/20230710221329.png)


### API 网关

网关主要用于请求转发、安全认证、协议转换、容灾。

SpringCloud Gateway 是 Spring Cloud 的一个全新项目，为了取代 Netflix Zuul。

### 配置中心

微服务下，业务的发展一般会导致服务数量的增加，进而导致程序配置（服务地址、数据库参数等等）增多。

传统的配置文件的方式已经无法满足当前需求，主要有两点原因：一是安全性得不到保障（配置放在代码库中容易泄露）；二是时效性不行 （修改配置需要重启服务才能生效）。

Spring Cloud Config、Nacos 、Apollo、K8s ConfigMap 都可以用来做配置中心。

Apollo 和 Nacos 我个人更喜欢。Nacos 使用起来更加顺手，Apollo 在配置管理方面做的更加全面。

### 分布式 id

日常开发中，我们需要对系统中的各种数据使用 ID 唯一表示，比如用户 ID 对应且仅对应一个人，商品 ID 对应且仅对应一件商品，订单 ID 对应且仅对应一个订单。
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/20230710221351.png)


简单来说，**ID 就是数据的唯一标识**。

分布式 ID 是分布式系统下的 ID。分布式 ID 不存在与现实生活中，属于计算机系统中的一个概念。

我简单举一个分库分表的例子。

我司的一个项目，使用的是单机 MySQL 。但是，没想到的是，项目上线一个月之后，随着使用人数越来越多，整个系统的数据量将越来越大。

单机 MySQL 已经没办法支撑了，需要进行分库分表（推荐 Sharding-JDBC）。

在分库之后， 数据遍布在不同服务器上的数据库，数据库的自增主键已经没办法满足生成的主键唯一了。**我们如何为不同的数据节点生成全局唯一主键呢？**
![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/20230710221403.png)


这个时候就需要生成**分布式 ID**了。

分布式 ID 的解决方案有很多比如 ：

- 算法 ：UUID、Snowflake
  
- 开源框架 ： UidGenerator、Leaf 、Tinyid
  

### 分布式事务

微服务架构下，一个系统被拆分为多个小的微服务。

每个微服务都可能存在不同的机器上，并且每个微服务可能都有一个单独的数据库供自己使用。这种情况下，一组操作可能会涉及到多个微服务以及多个数据库。

举个例子：电商系统中，你创建一个订单往往会涉及到订单服务（订单数加一）、库存服务（库存减一）等等服务，这些服务会有供自己单独使用的数据库。

![image.png](https://raw.githubusercontent.com/OtherGods/MaterialImage/main/img/20230710221413.png)


**那么如何保证这一组操作要么都执行成功，要么都执行失败呢？**

这个时候单单依靠数据库事务就不行了！我们就需要引入 **分布式事务** 这个概念了！

常用分布式事务解决方案有 Seata 和 Hmily。

1. [**Seata**](https://link.zhihu.com/?target=https%3A//seata.io/zh-cn/index.html) :Seata 是一款开源的分布式事务解决方案，致力于在微服务架构下提供高性能和简单易用的分布式事务服务。
   
2. [**Hmily**](https://link.zhihu.com/?target=https%3A//gitee.com/shuaiqiyu/hmily) : 金融级分布式事务解决方案
   

### 分布式链路追踪

不同于单体架构，在分布式架构下，请求需要在多个服务之间调用，排查问题会非常麻烦。我们需要分布式链路追踪系统来解决这个痛点。

目前分布式链路追踪系统基本都是根据谷歌的《Dapper 大规模分布式系统的跟踪系统》这篇论文发展而来，主流的有 Pinpoint，Skywalking ，CAT（当然也有其他的例如 Zipkin，Jaeger 等产品，不过总体来说不如前面选取的 3 个完成度高）等。

Zipkin 是 Twitter 公司开源的一个分布式链路追踪工具，Spring Cloud Sleuth 实际是基于 Zipkin 的。

SkyWalking 是国人吴晟（华为）开源的一款分布式追踪，分析，告警的工具，现在是 Apache 旗下开源项目